function [K11aint, K11bint, K11eint, K11gint, ...
    K12cint, K12dint, K12fint, K12hint, ...
    K21aint, K21bint, K21eint, K21gint, ...
    K22cint, K22dint, K22fint, K22hint] = quadinvsquarekernelmatrices(x,z)

%finds the kernel K11

K11aint = real(4.*(4+3.*x.^2+(-4).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2));

  
  
K11bint = real(8.*(4+(x+(-1).*z).^2).^(-2).*(x+(-1).*z));

K11eint = real(8.*x.*(4+2.*x.^2+(-3).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2)+ ...
...
  (-4).*atan((1/2).*(x+(-1).*z)));

K11gint = real(8.*x.^(-1).*(4+z.^2).^(-3).*((-4)+3.*z.^2)+(-8).*(4+z.^2).^(-2).*( ...
...
  4+x.^2+(-2).*x.*z+z.^2).^(-2).*(4.*x+(-12).*z+(-1).*x.*z.^2+z.^3)+ ...
...
  8.*(4+z.^2).^(-3).*(4+x.^2+(-2).*x.*z+z.^2).^(-1).*(28.*z+(-9).* ...
...
  z.^3+x.*((-8)+6.*z.^2))+6.*((sqrt(-1)*(-2))+z).^(-4).*atan(2.*(x+( ...
...
  -1).*z).^(-1))+6.*((sqrt(-1)*2)+z).^(-4).*atan(2.*(x+(-1).*z).^( ...
...
  -1))+(-96).*z.*((-4)+z.^2).*(4+z.^2).^(-4).*log(x)+(sqrt(-1)*(-3)) ...
...
  .*((sqrt(-1)*(-2))+z).^(-4).*log(4+x.^2+(-2).*x.*z+z.^2)+(sqrt(-1) ...
...
  *3).*((sqrt(-1)*2)+z).^(-4).*log(4+x.^2+(-2).*x.*z+z.^2));

%finds the kernel K12

K12cint = real(2.*(4+(x+(-1).*z).^2).^(-2).*((-8).*x+(-1).*(4+(x+(-1).*z).^2).*z) ...
  +(1/2).*z.*log(4+(x+(-1).*z).^2)+(-1).*z.*log(x+(-1).*z));
  
  
K12dint = real((-2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2).*(12+x.^2+(-2).*x.*z+z.^2)+( ...
  1/2).*log(4+(x+(-1).*z).^2)+(-1).*log(x+(-1).*z));

K12fint = real((1/2).*(32.*(4+(-2).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2)+( ...
...
  -4).*(12+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-1)+z.^2.*log(4+(x+(-1) ...
...
  .*z).^2)+(-2).*z.^2.*log(x+(-1).*z)));

K12hint = real((1/4).*(64.*(4+2.*x.*z+(-3).*z.^2).*(4+z.^2).^(-2).*(4+x.^2+(-2).* ...
...
  x.*z+z.^2).^(-2)+64.*x.^(-1).*z.^(-1).*(4+z.^2).^(-3).*((-4)+3.* ...
...
  z.^2)+(-8).*(4+z.^2).^(-3).*(4+x.^2+(-2).*x.*z+z.^2).^(-1).*((-80) ...
...
  +(-64).*x.*z+112.*z.^2+z.^4)+(sqrt(-1)*2).*((sqrt(-1)*(-2))+z).^( ...
...
  -4).*((-24)+(sqrt(-1)*(-8)).*z+z.^2).*atan(2.*(x+(-1).*z).^(-1))+( ...
...
  sqrt(-1)*(-2)).*((sqrt(-1)*2)+z).^(-4).*((-24)+(sqrt(-1)*8).*z+ ...
...
  z.^2).*atan(2.*(x+(-1).*z).^(-1))+64.*z.^(-2).*(4+z.^2).^(-4).*( ...
...
  16+40.*z.^2+(-15).*z.^4).*log(x)+((sqrt(-1)*(-2))+z).^(-4).*((-24) ...
...
  +(sqrt(-1)*(-8)).*z+z.^2).*log(4+(x+(-1).*z).^2)+((sqrt(-1)*2)+z) ...
...
  .^(-4).*((-24)+(sqrt(-1)*8).*z+z.^2).*log(4+(x+(-1).*z).^2)+(-4).* ...
...
  z.^(-2).*log(x+(-1).*z)));



%finds the kernel K21

K21aint = -real(16.*x.*(4+(x+(-1).*z).^2).^(-2)+(-8).*x.*(4+(x+(-1).*z).^2).^(-1)+ ...
  2.*(4+(x+(-1).*z).^2).^(-1).*z+4.*atan((1/2).*(x+(-1).*z))+(-1/2) ...
  .*z.*log(4+(x+(-1).*z).^2)+z.*log(x+(-1).*z));
  
  
  
K21bint = -real(2.*(8+(-3).*(4+(x+(-1).*z).^2)).*(4+(x+(-1).*z).^2).^(-2)+(-1/2).* ...
  log(4+(x+(-1).*z).^2)+log(x+(-1).*z));

K21eint = -real(16.*((-4).*(4+(x+(-1).*z).^2).^(-2)+(7/2).*(4+(x+(-1).*z).^2).^( ...
 ...
 -1)+2.*x.*(4+(x+(-1).*z).^2).^(-2).*z+(-1).*x.*(4+(x+(-1).*z).^2) ...
...
  .^(-1).*z+(-1).*(4+(x+(-1).*z).^2).^(-2).*z.^2+(5/8).*(4+(x+(-1).* ...
...
  z).^2).^(-1).*z.^2+(-1/2).*z.*atan(2.*(x+(-1).*z).^(-1))+(-1/32).* ...
...
  ((-16)+z.^2).*log(4+(x+(-1).*z).^2)+(1/16).*z.^2.*log(x+(-1).*z)));

K21gint = -real((1/4).*((-64).*(4+2.*x.*z+(-3).*z.^2).*(4+z.^2).^(-2).*(4+x.^2+( ...
 ...
 -2).*x.*z+z.^2).^(-2)+64.*x.^(-1).*z.^(-1).*(4+z.^2).^(-3).*(4+ ...
 ...
 z.^2+z.^4)+8.*(4+z.^2).^(-3).*(4+x.^2+(-2).*x.*z+z.^2).^(-1).*(( ...
...
  -16)+80.*z.^2+(-11).*z.^4+8.*x.*z.*((-4)+z.^2))+(sqrt(-1)*(-2)).*( ...
...
  (sqrt(-1)*(-2))+z).^(-4).*((-8)+z.^2).*atan(2.*(x+(-1).*z).^(-1))+ ...
...
  (sqrt(-1)*2).*((sqrt(-1)*2)+z).^(-4).*((-8)+z.^2).*atan(2.*(x+(-1) ...
...
  .*z).^(-1))+(-64).*z.^(-2).*(4+z.^2).^(-4).*(16+24.*z.^2+(-7).* ...
...
  z.^4+3.*z.^6).*log(x)+(-1).*((sqrt(-1)*(-2))+z).^(-4).*((-8)+z.^2) ...
...
  .*log(4+(x+(-1).*z).^2)+(-1).*((sqrt(-1)*2)+z).^(-4).*((-8)+z.^2) ...
...
  .*log(4+(x+(-1).*z).^2)+4.*z.^(-2).*log(x+(-1).*z)));



%finds the kernel K22

K22cint = -real(4.*(4+3.*x.^2+(-4).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2));

  
  
K22dint = -real(8.*(4+(x+(-1).*z).^2).^(-2).*(x+(-1).*z));

K22fint = -real(8.*x.*(4+2.*x.^2+(-3).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2)+ ...
...
  (-4).*atan((1/2).*(x+(-1).*z)));

K22hint = -real(8.*x.^(-1).*(4+z.^2).^(-3).*((-4)+3.*z.^2)+(-8).*(4+z.^2).^(-2).*( ...
...
  4+x.^2+(-2).*x.*z+z.^2).^(-2).*(4.*x+(-12).*z+(-1).*x.*z.^2+z.^3)+ ...
...
  8.*(4+z.^2).^(-3).*(4+x.^2+(-2).*x.*z+z.^2).^(-1).*(28.*z+(-9).* ...
...
  z.^3+x.*((-8)+6.*z.^2))+6.*((sqrt(-1)*(-2))+z).^(-4).*atan(2.*(x+( ...
...
  -1).*z).^(-1))+6.*((sqrt(-1)*2)+z).^(-4).*atan(2.*(x+(-1).*z).^( ...
...
  -1))+(-96).*z.*((-4)+z.^2).*(4+z.^2).^(-4).*log(x)+(sqrt(-1)*(-3)) ...
...
  .*((sqrt(-1)*(-2))+z).^(-4).*log(4+x.^2+(-2).*x.*z+z.^2)+(sqrt(-1) ...
...
  *3).*((sqrt(-1)*2)+z).^(-4).*log(4+x.^2+(-2).*x.*z+z.^2));
  
  
  
return
end