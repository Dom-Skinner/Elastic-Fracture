function [K11x3, K11x2, K11x1, K11x0, ...
    K12x3, K12x2, K12x1, K12x0, ...
    K21x3, K21x2, K21x1, K21x0, ...
    K22x3, K22x2, K22x1, K22x0] = x3_to_x0_kernel(x,z)

%finds the kernel K11

K11x3 = real(4.*(((-28)+12.*x.*z+(-3).*z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-1)+ ...
 ...
 2.*(4+x.^2+(-2).*x.*z+z.^2).^(-2).*(16+(-1).*z.^4+x.*z.*((-12)+ ...
 ...
 z.^2))+3.*z.*atan(2.*(x+(-1).*z).^(-1))+(-3).*log(4+x.^2+(-2).*x.* ...
...
  z+z.^2)));

K11x1 = real(4.*(4+3.*x.^2+(-4).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2));

  
  
K11x0 = real(8.*(4+(x+(-1).*z).^2).^(-2).*(x+(-1).*z));

K11x2 = real(8.*x.*(4+2.*x.^2+(-3).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2)+ ...
...
  (-4).*atan((1/2).*(x+(-1).*z)));

%finds the kernel K12

K12x3 = real(64.*x.*(4+(x+(-1).*z).^2).^(-2)+(-32).*x.*(4+(x+(-1).*z).^2).^(-1) ...
...
  +128.*(4+(x+(-1).*z).^2).^(-2).*z+(-40).*(4+(x+(-1).*z).^2).^(-1) ...
...
  .*z+(-48).*x.*(4+(x+(-1).*z).^2).^(-2).*z.^2+32.*(4+(x+(-1).*z) ...
...
  .^2).^(-2).*z.^3+(-2).*(4+(x+(-1).*z).^2).^(-1).*z.^3+8.*atan(( ...
...
  1/2).*(x+(-1).*z))+(1/2).*z.^3.*log(4+(x+(-1).*z).^2)+(-1).*z.^3.* ...
...
  log(x+(-1).*z));

K12x1 = real(2.*(4+(x+(-1).*z).^2).^(-2).*((-8).*x+(-1).*(4+(x+(-1).*z).^2).*z) ...
  +(1/2).*z.*log(4+(x+(-1).*z).^2)+(-1).*z.*log(x+(-1).*z));
  
  
K12x0 = real((-2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2).*(12+x.^2+(-2).*x.*z+z.^2)+( ...
  1/2).*log(4+(x+(-1).*z).^2)+(-1).*log(x+(-1).*z));

K12x2 = real((1/2).*(32.*(4+(-2).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2)+( ...
...
  -4).*(12+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-1)+z.^2.*log(4+(x+(-1) ...
...
  .*z).^2)+(-2).*z.^2.*log(x+(-1).*z)));


%finds the kernel K21

K21x3 = -real(16.*(x+(-4).*x.*(4+(x+(-1).*z).^2).^(-2)+4.*x.*(4+(x+(-1).*z).^2) ...
...
  .^(-1)+(-8).*(4+(x+(-1).*z).^2).^(-2).*z+(13/2).*(4+(x+(-1).*z) ...
...
  .^2).^(-1).*z+3.*x.*(4+(x+(-1).*z).^2).^(-2).*z.^2+(-3/2).*x.*(4+( ...
...
  x+(-1).*z).^2).^(-1).*z.^2+(-2).*(4+(x+(-1).*z).^2).^(-2).*z.^3+( ...
...
  9/8).*(4+(x+(-1).*z).^2).^(-1).*z.^3+((7/2)+(-3/4).*z.^2).*atan( ...
...
  2.*(x+(-1).*z).^(-1))+(-1/32).*z.*((-48)+z.^2).*log(4+(x+(-1).*z) ...
...
  .^2)+(1/16).*z.^3.*log(x+(-1).*z)));

K21x1 = -real(16.*x.*(4+(x+(-1).*z).^2).^(-2)+(-8).*x.*(4+(x+(-1).*z).^2).^(-1)+ ...
  2.*(4+(x+(-1).*z).^2).^(-1).*z+4.*atan((1/2).*(x+(-1).*z))+(-1/2) ...
  .*z.*log(4+(x+(-1).*z).^2)+z.*log(x+(-1).*z));
  
  
  
K21x0 = -real(2.*(8+(-3).*(4+(x+(-1).*z).^2)).*(4+(x+(-1).*z).^2).^(-2)+(-1/2).* ...
  log(4+(x+(-1).*z).^2)+log(x+(-1).*z));

K21x2 = -real(16.*((-4).*(4+(x+(-1).*z).^2).^(-2)+(7/2).*(4+(x+(-1).*z).^2).^( ...
 ...
 -1)+2.*x.*(4+(x+(-1).*z).^2).^(-2).*z+(-1).*x.*(4+(x+(-1).*z).^2) ...
...
  .^(-1).*z+(-1).*(4+(x+(-1).*z).^2).^(-2).*z.^2+(5/8).*(4+(x+(-1).* ...
...
  z).^2).^(-1).*z.^2+(-1/2).*z.*atan(2.*(x+(-1).*z).^(-1))+(-1/32).* ...
...
  ((-16)+z.^2).*log(4+(x+(-1).*z).^2)+(1/16).*z.^2.*log(x+(-1).*z)));



%finds the kernel K22

K22x3 = -real(4.*(((-28)+12.*x.*z+(-3).*z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-1)+ ...
 ...
 2.*(4+x.^2+(-2).*x.*z+z.^2).^(-2).*(16+(-1).*z.^4+x.*z.*((-12)+ ...
 ...
 z.^2))+3.*z.*atan(2.*(x+(-1).*z).^(-1))+(-3).*log(4+x.^2+(-2).*x.* ...
...
  z+z.^2)));

K22x1 = -real(4.*(4+3.*x.^2+(-4).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2));

  
  
K22x0 = -real(8.*(4+(x+(-1).*z).^2).^(-2).*(x+(-1).*z));

K22x2 = -real(8.*x.*(4+2.*x.^2+(-3).*x.*z+z.^2).*(4+x.^2+(-2).*x.*z+z.^2).^(-2)+ ...
...
  (-4).*atan((1/2).*(x+(-1).*z)));
  
  
  
return
end